<!DOCTYPE html>
<html lang="en" data-theme="dark">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>NeuralScribe — Handwriting Recognition</title>
<link href="https://fonts.googleapis.com/css2?family=Caveat:wght@400;500;600;700&family=Geist+Mono:wght@400;500;600;700;800&family=Outfit:wght@300;400;500;600;700;800&family=Syne:wght@400;500;600;700;800&display=swap" rel="stylesheet">
<link rel="stylesheet" href="/static/style.css">
</head>
<body>
<div class="page">

  <!-- ======== HEADER ======== -->
  <header class="hdr">
    <div class="brand">
      <span class="brand-name">Neural</span><span class="brand-scribe">Scribe</span>
      <span class="brand-sub">EMNIST · 47 Classes</span>
    </div>
    <div class="hdr-r">
      <div class="pill pill-off" id="sPill">
        <span class="dot"></span>
        <span id="sTxt">INIT</span>
      </div>
      <button class="btn" id="thBtn">Theme</button>
      <button class="btn btn-danger" id="btnOff">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><path d="M18 6L6 18M6 6l12 12"/></svg>
        Close
      </button>
    </div>
  </header>

  <!-- ======== GRID ======== -->
  <div class="grid">

    <!-- R1C1: Draw -->
    <div class="card draw-cell">
      <div class="card-h">
        <span class="card-t">Input Canvas</span>
        <span class="tag">28×28</span>
      </div>
      <div class="draw-body">
        <div class="cvs-wrap">
          <canvas id="drawCanvas"></canvas>
          <div class="draw-hint" id="drawHint">Draw here</div>
        </div>
      </div>
    </div>

    <!-- R1C2: Neural Network (6 layers) -->
    <div class="net-cell">
      <div class="net-top">
        <span class="card-t green">Network</span>
        <span class="tag tag-green">CNN · 650K</span>
      </div>
      <canvas class="net-canvas" id="netCvs"></canvas>
      <div class="net-labels">
        <span>Input</span>
        <span>Conv 1</span>
        <span>Conv 2</span>
        <span>Dense 1</span>
        <span>Dense 2</span>
        <span>Output (47)</span>
      </div>
    </div>

    <!-- R1C3: Accuracy Chart -->
    <div class="card acc-cell">
      <div class="card-h">
        <span class="card-t green">Accuracy</span>
        <span class="tag" id="epTag">0 ep</span>
      </div>
      <div class="chart-body">
        <div class="chart-sq"><canvas id="chAcc"></canvas></div>
      </div>
    </div>

    <!-- R2C1: Controls + Prediction -->
    <div class="bot-left">
      <div class="btn-row">
        <button class="btn" id="btnCl">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M3 6h18M8 6V4a1 1 0 011-1h6a1 1 0 011 1v2m2 0v12a2 2 0 01-2 2H8a2 2 0 01-2-2V6h12z"/></svg>
          Clear
        </button>
        <button class="btn" id="btnUndo">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M3 10h10a5 5 0 015 5v0a5 5 0 01-5 5H8M3 10l4-4M3 10l4 4"/></svg>
          Undo
        </button>
        <button class="btn btn-accent" id="btnTr">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polygon points="5 3 19 12 5 21 5 3"/></svg>
          Train
        </button>
        <button class="btn btn-danger" id="btnRs">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M1 4v6h6M23 20v-6h-6"/><path d="M20.49 9A9 9 0 005.64 5.64L1 10m22 4l-4.64 4.36A9 9 0 013.51 15"/></svg>
          Reset
        </button>
      </div>

      <div class="card">
        <div class="card-h">
          <span class="card-t">Prediction</span>
          <span class="tag" id="mSt">No Model</span>
        </div>
        <div class="pred-wrap">
          <div class="pred-char" id="pDig">—</div>
          <div class="pred-meta">
            <div class="lbl">Confidence</div>
            <div class="val" id="pConf">0.0%</div>
            <div class="sub" id="pMs">—</div>
          </div>
        </div>
        <div class="stats">
          <div class="stat"><div class="stat-l">Accuracy</div><div class="stat-v c-green" id="sAcc">—</div></div>
          <div class="stat"><div class="stat-l">Inference</div><div class="stat-v c-accent" id="sInf">—</div></div>
          <div class="stat"><div class="stat-l">Loss</div><div class="stat-v c-amber" id="sLoss">—</div></div>
          <div class="stat"><div class="stat-l">Device</div><div class="stat-v" id="sDev">—</div></div>
        </div>
        <div class="prg" id="prg">
          <div class="prg-track"><div class="prg-fill" id="prgFl"></div></div>
          <div class="prg-info">
            <span id="prgEp">Epoch 0/0</span>
            <span id="prgEta"></span>
            <span id="prgAc">0%</span>
          </div>
        </div>
      </div>
    </div>

    <!-- R2C2: Confidence Bars -->
    <div class="card conf-cell">
      <div class="card-h">
        <span class="card-t">Probabilities</span>
        <span class="tag">47 classes</span>
      </div>
      <div class="conf-body">
        <div class="vb-section">
          <div class="vb-header">
            <span class="vb-title dig">Digits 0–9</span>
            <span class="vb-line dig"></span>
          </div>
          <div class="vb-row digits" id="digBars"></div>
        </div>
        <div class="vb-section">
          <div class="vb-header">
            <span class="vb-title let">Letters A–Z</span>
            <span class="vb-line let"></span>
          </div>
          <div class="vb-row letters" id="letBars"></div>
        </div>
      </div>
    </div>

    <!-- R2C3: Loss Chart -->
    <div class="card loss-cell">
      <div class="card-h">
        <span class="card-t amber">Loss</span>
      </div>
      <div class="chart-body">
        <div class="chart-sq"><canvas id="chLoss"></canvas></div>
      </div>
    </div>

  </div>

  <!-- ======== FOOTER ======== -->
  <div class="ftr">
    <span id="fSt">INITIALIZING...</span>
    <span id="fFps">— FPS</span>
  </div>

</div>

<!-- Toast -->
<div class="toast" id="toast"></div>

<!-- Train Modal — slider max 100 -->
<div class="modal-overlay" id="mTrain">
  <div class="modal-box">
    <h2>Train Network</h2>
    <p>Downloads EMNIST (~500 MB first run). With warm restarts, 30–50 epochs recommended. GPU: ~10–20 min.</p>
    <div class="slider-group">
      <label>Epochs <span id="epCnt">35</span></label>
      <input type="range" id="epSl" min="5" max="100" value="35">
    </div>
    <div class="modal-btns">
      <button class="btn" id="mCancel">Cancel</button>
      <button class="btn btn-accent" id="mStart">Start Training</button>
    </div>
  </div>
</div>

<!-- Shutdown Modal -->
<div class="modal-overlay" id="mShut">
  <div class="modal-box">
    <h2>Shut Down</h2>
    <p>Kill the backend server. Run <code>python run_backend.py</code> to restart.</p>
    <div class="modal-btns">
      <button class="btn" id="mShutNo">Cancel</button>
      <button class="btn btn-danger" id="mShutYes">Shut Down</button>
    </div>
  </div>
</div>

<!-- App Entry — ES Modules -->
<script type="module" src="/static/main.js"></script>
</body>
</html>